<div class="main-container">
  <div class="container">
    <mat-card-content class="form-main-wrapper">
      <div class="heading text-center">
        <h1>Sign Up</h1>
      </div>
      <mat-stepper [linear]="true" #stepper>

        <mat-step [stepControl]="personalDetailsFormGroup">
          <form [formGroup]="personalDetailsFormGroup">
            <ng-template matStepLabel>Personal Details</ng-template>
            <div class="row">
              <div class="col-6">
                <mat-form-field>
                  <mat-label>Full Name</mat-label>
                  <input matInput formControlName="name" type="text">
                  <mat-error *ngIf="personalDetailsFormGroup.get('name')?.hasError('required')">
                    Full Name is required
                  </mat-error>
                  <mat-error *ngIf="personalDetailsFormGroup.get('name')?.hasError('minlength')">
                    Name should have atleast 3 characters
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="col-6">
                <mat-form-field>
                  <mat-label>Email Id</mat-label>
                  <input matInput formControlName="email" type="email">
                  <mat-error *ngIf="personalDetailsFormGroup.get('email')?.hasError('required')">
                    Email is required
                  </mat-error>
                  <mat-error *ngIf="personalDetailsFormGroup.get('email')?.hasError('email')">
                    Invalid email address
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <div class="row">
              <div class="col-6 date-wrapper">
                <mat-form-field>
                  <mat-label>Password</mat-label>
                  <input matInput formControlName="password" [type]="hide() ? 'password' : 'text'" />
                  <button mat-icon-button matSuffix type="button" (click)="clickEvent($event)"
                    [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide()">
                    <mat-icon>{{hide() ? 'visibility_off' : 'visibility'}}</mat-icon>
                  </button>
                  <mat-error *ngIf="personalDetailsFormGroup.get('password')?.hasError('required')">
                    Password is required
                  </mat-error>
                  <mat-error *ngIf="personalDetailsFormGroup.get('password')?.hasError('minlength')">
                    Password must at least 4 characters long
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="col-6 date-wrapper">
                <mat-form-field>
                  <mat-label>Date of Birth</mat-label>
                  <input matInput [matDatepicker]="picker" (focus)="picker.open()" readonly formControlName="dob">
                  <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-datepicker #picker></mat-datepicker>
                  <mat-error *ngIf="personalDetailsFormGroup.get('dob')?.hasError('required')">
                    Date of birth is required
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <div class="row">
              <div class="col-6">
                <mat-form-field>
                  <mat-label>Contact No.</mat-label>
                  <input matInput formControlName="contact" type="text">
                  <mat-error *ngIf="personalDetailsFormGroup.get('contact')?.hasError('required')">
                    Contact number is required
                  </mat-error>
                  <mat-error *ngIf="personalDetailsFormGroup.get('contact')?.hasError('pattern')">
                    Must be a 10-digit number
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="col-6">
                <div class="w-100">
                  <label for="formFile" class="form-label text-start">Profile image</label>
                </div>
                <div class="mb-2 w-100 d-flex align-items-center gap-2">
                  <div class="profile-wrap">
                    <input class="form-control" type="file" id="image" formControlName="image"
                      (change)="onFileChange($event)">
                  </div>

                  @if (imagePreview) {
                  <div class="img-wrap">
                    <img class="preview-img" [src]="imagePreview" alt="image-preview">
                  </div>
                  }
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-6">
                <a href="" class="create-link" [routerLink]="['/auth/signin']"><strong>Already a user?</strong></a>
              </div>

              <div class="col-6 position-end">
                <button mat-button color="accent" matStepperNext>Next</button>
                </div>
            </div>
          </form>
        </mat-step>

        <mat-step [stepControl]="addressDetailsFormGroup" label="Address Details">
          <form [formGroup]="addressDetailsFormGroup">
            <div class="row">
              <div class="col-12">
                <mat-form-field>
                  <mat-label>Address</mat-label>
                  <textarea matInput formControlName="address" rows="4"></textarea>
                  <mat-error *ngIf="addressDetailsFormGroup.get('address')?.hasError('required')">
                    Address is required
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <div class="row">
              <div class="col-6">
                <mat-form-field>
                  <mat-label>City</mat-label>
                  <input matInput formControlName="city" type="text">
                </mat-form-field>
              </div>

              <div class="col-6">
                <mat-form-field>
                  <mat-label>Zipcode</mat-label>
                  <input matInput formControlName="zipcode" type="text">
                  <mat-error *ngIf="addressDetailsFormGroup.get('zipcode')?.hasError('pattern')">
                    Must be a 5-6 digit number
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <div class="position-end">
              <button mat-button color="warn" matStepperPrevious>Back</button>
              <button mat-button color="accent" matStepperNext>Next</button>
            </div>
          </form>
        </mat-step>

        <mat-step [stepControl]="workDetailsFormGroup" label="Work Details">
          <form [formGroup]="workDetailsFormGroup">
            <div class="row">
              <div class="col-6">
                <mat-form-field>
                  <mat-label>Employee Type</mat-label>
                  <mat-select formControlName="emp_type">
                    <mat-option *ngFor="let empType of empTypeList"
                      [value]="empType.value">{{empType.displayValue}}</mat-option>
                  </mat-select>
                  <mat-error *ngIf="workDetailsFormGroup.get('emp_type')?.hasError('required')">
                    Employee Type is required
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="col-6">
                <mat-form-field>
                  <mat-label>Work Type</mat-label>
                  <mat-select formControlName="work_type">
                    <mat-option *ngFor="let workType of workTypeList"
                      [value]="workType.value">{{workType.displayValue}}</mat-option>
                  </mat-select>
                  <mat-error *ngIf="workDetailsFormGroup.get('work_type')?.hasError('required')">
                    Work Type is required
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <div class="row">
              <div class="col-6">
                <mat-form-field>
                  <mat-label>Experience</mat-label>
                  <input matInput formControlName="experience" type="number">
                  <mat-error *ngIf="workDetailsFormGroup.get('experience')?.hasError('required')">
                    Experience is required
                  </mat-error>
                  <mat-error *ngIf="workDetailsFormGroup.get('experience')?.hasError('min')">
                    Experience must be a positive number
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="col-6">
                <mat-form-field>
                  <mat-label>Salary</mat-label>
                  <input matInput formControlName="salary" type="number">
                  <mat-error *ngIf="workDetailsFormGroup.get('salary')?.hasError('required')">
                    Salary is required
                  </mat-error>
                  <mat-error *ngIf="workDetailsFormGroup.get('salary')?.hasError('min')">
                    Salary must be a positive number
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <div class="row">
              <div class="col-6 date-wrapper">
                <mat-form-field>
                  <mat-label>Date of Joining</mat-label>
                  <input matInput [matDatepicker]="picker1" (focus)="picker1.open()" readonly formControlName="doj">
                  <mat-datepicker-toggle matIconSuffix [for]="picker1"></mat-datepicker-toggle>
                  <mat-datepicker #picker1></mat-datepicker>
                  <mat-error *ngIf="workDetailsFormGroup.get('doj')?.hasError('required')">
                    Date of joining is required
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="col-6">
                <mat-form-field>
                  <mat-label>Worked Technologies</mat-label>
                  <mat-select formControlName="worked_technologies" multiple>
                    <mat-option *ngFor="let workedTechnology of workedTechnologies" [value]="workedTechnology.value">
                      {{workedTechnology.displayValue}}
                    </mat-option>
                  </mat-select>
                  <mat-error *ngIf="workDetailsFormGroup.get('worked_technologies')?.hasError('required')">
                    Please select at least one technology
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <div class="row">
              <div class="col-6">
                <a href="" class="create-link" [routerLink]="['/auth/signin']"><strong>Already a user?</strong></a>
              </div>

              <div class="col-6 position-end">
                <button mat-button color="warn" matStepperPrevious>Back</button>
                <button mat-flat-button color="accent" [disabled]="workDetailsFormGroup.invalid"
                  (click)="onSignUp()">Submit</button>
              </div>
            </div>
          </form>
        </mat-step>
      </mat-stepper>
    </mat-card-content>
  </div>
</div>
